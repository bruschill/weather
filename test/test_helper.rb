ENV["RAILS_ENV"] ||= "test"
require_relative "../config/environment"
require "rails/test_help"

require "webmock/minitest"
WebMock.disable_net_connect!(allow_localhost: true)

class ActiveSupport::TestCase
  # Run tests in parallel with specified workers
  parallelize(workers: :number_of_processors)

  setup do
    # REQUEST STUBS
    # OpenWeatherMapAPI - geocode_by_postal_code
    response_body = "{\"zip\":\"50322\",\"name\":\"Urbandale\",\"lat\":41.6295,\"lon\":-93.723,\"country\":\"US\"}"
    stub_request(:get, /\/geo\/1.0\/zip/)
      .with(
        headers: {
          "Accept" => "*/*",
          "Accept-Encoding" => "gzip;q=1.0,deflate;q=0.6,identity;q=0.3",
          "User-Agent" => "Faraday v2.9.0"
        }
      )
      .to_return(status: 200, body: response_body, headers: {})

    # OpenWeatherMapAPI - current_weather
    response_body = "{\"coord\":{\"lon\":-93.723,\"lat\":41.6295},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"base\":\"stations\",\"main\":{\"temp\":46.42,\"feels_like\":40.71,\"temp_min\":43.16,\"temp_max\":48.24,\"pressure\":1033,\"humidity\":58},\"visibility\":10000,\"wind\":{\"speed\":12.66,\"deg\":110},\"clouds\":{\"all\":75},\"dt\":1712371941,\"sys\":{\"type\":2,\"id\":268364,\"country\":\"US\",\"sunrise\":1712317804,\"sunset\":1712364262},\"timezone\":-18000,\"id\":4879890,\"name\":\"Urbandale\",\"cod\":200}"
    stub_request(:get, /\/data\/2.5\/weather/)
      .with(
        headers: {
          "Accept" => "*/*",
          "Accept-Encoding" => "gzip;q=1.0,deflate;q=0.6,identity;q=0.3",
          "User-Agent" => "Faraday v2.9.0"
        }
      )
      .to_return(status: 200, body: response_body, headers: {})

    # OpenWeatherMapAPI - five_day_forecast
    response_body = "{\"cod\":\"200\",\"message\":0,\"cnt\":40,\"list\":[{\"dt\":1712372400,\"main\":{\"temp\":46.15,\"feels_like\":41.68,\"temp_min\":43.5,\"temp_max\":46.15,\"pressure\":1036,\"sea_level\":1036,\"grnd_level\":988,\"humidity\":60,\"temp_kf\":1.47},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":8.9,\"deg\":120,\"gust\":21.77},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-06 03:00:00\"},{\"dt\":1712383200,\"main\":{\"temp\":44.67,\"feels_like\":39.76,\"temp_min\":41.74,\"temp_max\":44.67,\"pressure\":1031,\"sea_level\":1031,\"grnd_level\":988,\"humidity\":65,\"temp_kf\":1.63},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":31},\"wind\":{\"speed\":9.17,\"deg\":130,\"gust\":23.71},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-06 06:00:00\"},{\"dt\":1712394000,\"main\":{\"temp\":41.95,\"feels_like\":35.78,\"temp_min\":39.87,\"temp_max\":41.95,\"pressure\":1026,\"sea_level\":1026,\"grnd_level\":987,\"humidity\":71,\"temp_kf\":1.16},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":67},\"wind\":{\"speed\":10.69,\"deg\":118,\"gust\":25.97},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-06 09:00:00\"},{\"dt\":1712404800,\"main\":{\"temp\":37.53,\"feels_like\":29.48,\"temp_min\":37.53,\"temp_max\":37.53,\"pressure\":1021,\"sea_level\":1021,\"grnd_level\":987,\"humidity\":81,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":12.66,\"deg\":116,\"gust\":29.57},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-06 12:00:00\"},{\"dt\":1712415600,\"main\":{\"temp\":45.64,\"feels_like\":38.07,\"temp_min\":45.64,\"temp_max\":45.64,\"pressure\":1020,\"sea_level\":1020,\"grnd_level\":987,\"humidity\":62,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":35},\"wind\":{\"speed\":19.15,\"deg\":125,\"gust\":27.47},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-06 15:00:00\"},{\"dt\":1712426400,\"main\":{\"temp\":54.14,\"feels_like\":51.66,\"temp_min\":54.14,\"temp_max\":54.14,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":984,\"humidity\":51,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02d\"}],\"clouds\":{\"all\":20},\"wind\":{\"speed\":21.9,\"deg\":124,\"gust\":26.75},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-06 18:00:00\"},{\"dt\":1712437200,\"main\":{\"temp\":57.29,\"feels_like\":55.11,\"temp_min\":57.29,\"temp_max\":57.29,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":980,\"humidity\":51,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":31},\"wind\":{\"speed\":23.67,\"deg\":126,\"gust\":29.55},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-06 21:00:00\"},{\"dt\":1712448000,\"main\":{\"temp\":52.14,\"feels_like\":49.84,\"temp_min\":52.14,\"temp_max\":52.14,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":978,\"humidity\":59,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":35},\"wind\":{\"speed\":21.74,\"deg\":133,\"gust\":36.24},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-07 00:00:00\"},{\"dt\":1712458800,\"main\":{\"temp\":48.38,\"feels_like\":40.57,\"temp_min\":48.38,\"temp_max\":48.38,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":976,\"humidity\":65,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":66},\"wind\":{\"speed\":25.1,\"deg\":120,\"gust\":46.19},\"visibility\":10000,\"pop\":0.3,\"rain\":{\"3h\":0.29},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-07 03:00:00\"},{\"dt\":1712469600,\"main\":{\"temp\":44.13,\"feels_like\":35.74,\"temp_min\":44.13,\"temp_max\":44.13,\"pressure\":1007,\"sea_level\":1007,\"grnd_level\":974,\"humidity\":87,\"temp_kf\":0},\"weather\":[{\"id\":501,\"main\":\"Rain\",\"description\":\"moderate rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":83},\"wind\":{\"speed\":20.74,\"deg\":121,\"gust\":41.61},\"visibility\":10000,\"pop\":1,\"rain\":{\"3h\":5.7},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-07 06:00:00\"},{\"dt\":1712480400,\"main\":{\"temp\":44.69,\"feels_like\":36.41,\"temp_min\":44.69,\"temp_max\":44.69,\"pressure\":1003,\"sea_level\":1003,\"grnd_level\":970,\"humidity\":91,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":21.09,\"deg\":122,\"gust\":38.27},\"visibility\":10000,\"pop\":0.71,\"rain\":{\"3h\":0.4},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-07 09:00:00\"},{\"dt\":1712491200,\"main\":{\"temp\":45.66,\"feels_like\":38.16,\"temp_min\":45.66,\"temp_max\":45.66,\"pressure\":1001,\"sea_level\":1001,\"grnd_level\":969,\"humidity\":95,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":18.81,\"deg\":126,\"gust\":33.58},\"visibility\":10000,\"pop\":1,\"rain\":{\"3h\":0.85},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-07 12:00:00\"},{\"dt\":1712502000,\"main\":{\"temp\":48.42,\"feels_like\":42.67,\"temp_min\":48.42,\"temp_max\":48.42,\"pressure\":1000,\"sea_level\":1000,\"grnd_level\":968,\"humidity\":91,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":14.74,\"deg\":120,\"gust\":27.98},\"visibility\":10000,\"pop\":0.71,\"rain\":{\"3h\":0.47},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-07 15:00:00\"},{\"dt\":1712512800,\"main\":{\"temp\":62.33,\"feels_like\":60.48,\"temp_min\":62.33,\"temp_max\":62.33,\"pressure\":998,\"sea_level\":998,\"grnd_level\":966,\"humidity\":47,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10d\"}],\"clouds\":{\"all\":79},\"wind\":{\"speed\":16.93,\"deg\":183,\"gust\":19.46},\"visibility\":10000,\"pop\":0.79,\"rain\":{\"3h\":0.62},\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-07 18:00:00\"},{\"dt\":1712523600,\"main\":{\"temp\":63.12,\"feels_like\":61.16,\"temp_min\":63.12,\"temp_max\":63.12,\"pressure\":998,\"sea_level\":998,\"grnd_level\":966,\"humidity\":43,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":98},\"wind\":{\"speed\":18.37,\"deg\":197,\"gust\":34.05},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-07 21:00:00\"},{\"dt\":1712534400,\"main\":{\"temp\":58.95,\"feels_like\":57.16,\"temp_min\":58.95,\"temp_max\":58.95,\"pressure\":998,\"sea_level\":998,\"grnd_level\":966,\"humidity\":56,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":97},\"wind\":{\"speed\":13.6,\"deg\":208,\"gust\":28.19},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-08 00:00:00\"},{\"dt\":1712545200,\"main\":{\"temp\":51.44,\"feels_like\":49.48,\"temp_min\":51.44,\"temp_max\":51.44,\"pressure\":1000,\"sea_level\":1000,\"grnd_level\":968,\"humidity\":68,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":65},\"wind\":{\"speed\":14.65,\"deg\":237,\"gust\":28.74},\"visibility\":10000,\"pop\":0.26,\"rain\":{\"3h\":0.16},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-08 03:00:00\"},{\"dt\":1712556000,\"main\":{\"temp\":49.75,\"feels_like\":44.19,\"temp_min\":49.75,\"temp_max\":49.75,\"pressure\":1002,\"sea_level\":1002,\"grnd_level\":970,\"humidity\":75,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":66},\"wind\":{\"speed\":15.61,\"deg\":237,\"gust\":27.94},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-08 06:00:00\"},{\"dt\":1712566800,\"main\":{\"temp\":46.92,\"feels_like\":41.13,\"temp_min\":46.92,\"temp_max\":46.92,\"pressure\":1005,\"sea_level\":1005,\"grnd_level\":973,\"humidity\":86,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":79},\"wind\":{\"speed\":13.42,\"deg\":259,\"gust\":26.73},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-08 09:00:00\"},{\"dt\":1712577600,\"main\":{\"temp\":43.68,\"feels_like\":38.35,\"temp_min\":43.68,\"temp_max\":43.68,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":975,\"humidity\":88,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":52},\"wind\":{\"speed\":9.62,\"deg\":251,\"gust\":20.4},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-08 12:00:00\"},{\"dt\":1712588400,\"main\":{\"temp\":50.79,\"feels_like\":48.78,\"temp_min\":50.79,\"temp_max\":50.79,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":978,\"humidity\":68,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02d\"}],\"clouds\":{\"all\":19},\"wind\":{\"speed\":12.5,\"deg\":264,\"gust\":17.6},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-08 15:00:00\"},{\"dt\":1712599200,\"main\":{\"temp\":58.69,\"feels_like\":56.75,\"temp_min\":58.69,\"temp_max\":58.69,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":978,\"humidity\":53,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":59},\"wind\":{\"speed\":10.65,\"deg\":249,\"gust\":14.54},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-08 18:00:00\"},{\"dt\":1712610000,\"main\":{\"temp\":62.35,\"feels_like\":60.53,\"temp_min\":62.35,\"temp_max\":62.35,\"pressure\":1009,\"sea_level\":1009,\"grnd_level\":977,\"humidity\":48,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":98},\"wind\":{\"speed\":11.18,\"deg\":230,\"gust\":15.32},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-08 21:00:00\"},{\"dt\":1712620800,\"main\":{\"temp\":58.87,\"feels_like\":57.38,\"temp_min\":58.87,\"temp_max\":58.87,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":977,\"humidity\":62,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":4.9,\"deg\":219,\"gust\":5.97},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-09 00:00:00\"},{\"dt\":1712631600,\"main\":{\"temp\":52.72,\"feels_like\":50.97,\"temp_min\":52.72,\"temp_max\":52.72,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":978,\"humidity\":70,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":45},\"wind\":{\"speed\":8.23,\"deg\":177,\"gust\":12.84},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-09 03:00:00\"},{\"dt\":1712642400,\"main\":{\"temp\":49.89,\"feels_like\":46.9,\"temp_min\":49.89,\"temp_max\":49.89,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":978,\"humidity\":74,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02n\"}],\"clouds\":{\"all\":24},\"wind\":{\"speed\":7.34,\"deg\":204,\"gust\":13.67},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-09 06:00:00\"},{\"dt\":1712653200,\"main\":{\"temp\":46.72,\"feels_like\":43.12,\"temp_min\":46.72,\"temp_max\":46.72,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":978,\"humidity\":82,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":6},\"wind\":{\"speed\":7.25,\"deg\":294,\"gust\":13.96},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-09 09:00:00\"},{\"dt\":1712664000,\"main\":{\"temp\":43.54,\"feels_like\":37.67,\"temp_min\":43.54,\"temp_max\":43.54,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":980,\"humidity\":86,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02d\"}],\"clouds\":{\"all\":22},\"wind\":{\"speed\":10.92,\"deg\":332,\"gust\":23.31},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-09 12:00:00\"},{\"dt\":1712674800,\"main\":{\"temp\":49.55,\"feels_like\":45.01,\"temp_min\":49.55,\"temp_max\":49.55,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":981,\"humidity\":64,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":11.45,\"deg\":322,\"gust\":14.76},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-09 15:00:00\"},{\"dt\":1712685600,\"main\":{\"temp\":56.5,\"feels_like\":54.25,\"temp_min\":56.5,\"temp_max\":56.5,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":980,\"humidity\":51,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":9.04,\"deg\":308,\"gust\":11.59},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-09 18:00:00\"},{\"dt\":1712696400,\"main\":{\"temp\":59.29,\"feels_like\":57.04,\"temp_min\":59.29,\"temp_max\":59.29,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":980,\"humidity\":45,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":43},\"wind\":{\"speed\":8.39,\"deg\":296,\"gust\":11.18},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-09 21:00:00\"},{\"dt\":1712707200,\"main\":{\"temp\":56.28,\"feels_like\":54.19,\"temp_min\":56.28,\"temp_max\":56.28,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":979,\"humidity\":55,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":56},\"wind\":{\"speed\":6.67,\"deg\":333,\"gust\":10.27},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-10 00:00:00\"},{\"dt\":1712718000,\"main\":{\"temp\":49.77,\"feels_like\":46.87,\"temp_min\":49.77,\"temp_max\":49.77,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":980,\"humidity\":63,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":95},\"wind\":{\"speed\":7.09,\"deg\":2,\"gust\":10.38},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-10 03:00:00\"},{\"dt\":1712728800,\"main\":{\"temp\":47.82,\"feels_like\":45.37,\"temp_min\":47.82,\"temp_max\":47.82,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":979,\"humidity\":68,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":97},\"wind\":{\"speed\":5.48,\"deg\":57,\"gust\":6.58},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-10 06:00:00\"},{\"dt\":1712739600,\"main\":{\"temp\":46.24,\"feels_like\":44.31,\"temp_min\":46.24,\"temp_max\":46.24,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":978,\"humidity\":71,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":4.27,\"deg\":86,\"gust\":4.09},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2024-04-10 09:00:00\"},{\"dt\":1712750400,\"main\":{\"temp\":44.37,\"feels_like\":42.31,\"temp_min\":44.37,\"temp_max\":44.37,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":978,\"humidity\":75,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":4.05,\"deg\":13,\"gust\":4.12},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-10 12:00:00\"},{\"dt\":1712761200,\"main\":{\"temp\":50.59,\"feels_like\":48.27,\"temp_min\":50.59,\"temp_max\":50.59,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":979,\"humidity\":62,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":2.71,\"deg\":12,\"gust\":3.74},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-10 15:00:00\"},{\"dt\":1712772000,\"main\":{\"temp\":56.08,\"feels_like\":53.8,\"temp_min\":56.08,\"temp_max\":56.08,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":977,\"humidity\":51,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":3.94,\"deg\":5,\"gust\":5.32},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-10 18:00:00\"},{\"dt\":1712782800,\"main\":{\"temp\":60.1,\"feels_like\":57.88,\"temp_min\":60.1,\"temp_max\":60.1,\"pressure\":1007,\"sea_level\":1007,\"grnd_level\":975,\"humidity\":44,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":5.19,\"deg\":3,\"gust\":12.37},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-10 21:00:00\"},{\"dt\":1712793600,\"main\":{\"temp\":57.36,\"feels_like\":55.44,\"temp_min\":57.36,\"temp_max\":57.36,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":976,\"humidity\":56,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":93},\"wind\":{\"speed\":7.92,\"deg\":300,\"gust\":12.75},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2024-04-11 00:00:00\"}],\"city\":{\"id\":4879890,\"name\":\"Urbandale\",\"coord\":{\"lat\":41.6295,\"lon\":-93.723},\"country\":\"US\",\"population\":39463,\"timezone\":-18000,\"sunrise\":1712317804,\"sunset\":1712364262}}"
    stub_request(:get, /\/data\/2.5\/forecast/)
      .with(
        headers: {
          "Accept" => "*/*",
          "Accept-Encoding" => "gzip;q=1.0,deflate;q=0.6,identity;q=0.3",
          "User-Agent" => "Faraday v2.9.0"
        }
      )
      .to_return(status: 200, body: response_body, headers: {})
  end
  # Add more helper methods to be used by all tests here...
end
